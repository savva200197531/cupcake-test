{"version":3,"sources":["contexts/GetDataContext.js","components/Loading/Loading.js","components/Table/Table.js","App.js","index.js"],"names":["GetDataContext","React","createContext","undefined","GetDataProvider","children","requests","initialHeaders","currencyAttrs","useState","currencies","setCurrencies","headers","setHeaders","formCurrencies","newCurrencies","localRequests","map","request","axios","get","all","getCurrencies","then","res","forEach","attr","fillNewCurrencies","currency","currencyValues","attribute","push","value","lowestCurrency","finally","setTimeout","catch","error","console","row","split","numerator","denominator","preparedRow","resItem","idx","numeratorVal","data","rates","denominatorVal","pairCurrency","Object","keys","length","arr","reduce","p","v","Number","toFixed","useEffect","Provider","Loading","className","Table","useContext","header","name","classnames","first","lowest","second","third","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.118744a5.chunk.js","sourcesContent":["import React, { useContext, useState, useEffect } from 'react';\r\nimport axios from \"axios\";\r\n\r\nconst GetDataContext = React.createContext(undefined, undefined);\r\n\r\nexport const useGetData = () => useContext(GetDataContext);\r\n\r\nexport function GetDataProvider({ children }) {\r\n  // data generated from config (in this case from here)\r\n  let requests = [ 'first', 'second', 'third' ];\r\n  let initialHeaders = [ 'Pair name/market', 'First', 'Second', 'Third' ];\r\n  const currencyAttrs = [ 'RUB/CUPCAKE', 'USD/CUPCAKE', 'EUR/CUPCAKE', 'RUB/USD', 'RUB/EUR', 'EUR/USD' ];\r\n\r\n  // state\r\n  const [ currencies, setCurrencies ] = useState();\r\n  const [ headers, setHeaders ] = useState(initialHeaders);\r\n\r\n  // form request to api\r\n  const getCurrencies = () => {\r\n    const localRequests = requests.map(request => axios.get(`http://localhost:3000/api/v1/${request}`));\r\n    return axios.all(localRequests);\r\n  };\r\n\r\n  const formCurrencies = () => {\r\n    const newCurrencies = [];\r\n    setHeaders(initialHeaders);\r\n\r\n    getCurrencies().then(res => {\r\n      currencyAttrs.forEach(attr => {\r\n        fillNewCurrencies(newCurrencies, res, attr);\r\n      });\r\n\r\n      // iterate data and find lowest values\r\n      newCurrencies.forEach(currency => {\r\n        const currencyValues = [];\r\n        requests.map(attribute => {\r\n          currencyValues.push(currency[attribute].value)\r\n          return attribute;\r\n        }).forEach(attribute => {\r\n          currency[attribute]['lowest'] = currency[attribute].value === lowestCurrency(currencyValues);\r\n        });\r\n      })\r\n\r\n      setCurrencies(newCurrencies);\r\n\r\n    }).finally(() => {\r\n      // re-call function when data is get to get new data\r\n      setTimeout(() => {\r\n        formCurrencies();\r\n      }, 5000);\r\n\r\n    }).catch(error => {\r\n      // catch error and set display it in header\r\n      setCurrencies([]);\r\n      setHeaders(headers => {\r\n        return headers.map(() => 'Error');\r\n      })\r\n      console.error('error', error);\r\n    })\r\n  }\r\n\r\n  // fill currencies with data\r\n  const fillNewCurrencies = (newCurrencies, res, attr, row) => {\r\n    const [ numerator, denominator ] = attr.split('/');\r\n\r\n    const preparedRow = {};\r\n    res.forEach((resItem, idx) => {\r\n\r\n      const numeratorVal = resItem.data.rates[numerator],\r\n        denominatorVal = resItem.data.rates[denominator];\r\n\r\n      // check for existence of fields to avoid NaN fields\r\n      if (!numeratorVal || !denominatorVal) return;\r\n      preparedRow['name'] = attr;\r\n      preparedRow[requests[idx]] = { value: pairCurrency(numeratorVal, denominatorVal) };\r\n    });\r\n\r\n    if (!Object.keys(preparedRow).length) return;\r\n    // push the resulting objects to initial value;\r\n    newCurrencies.push(preparedRow);\r\n  }\r\n\r\n  // find minimum currency value in arr\r\n  const lowestCurrency = arr => arr.reduce((p, v) => (p < v ? p : v));\r\n\r\n  // calculate the ratio of currency pairs\r\n  const pairCurrency = (numerator, denominator) => Number((numerator / denominator).toFixed(2));\r\n\r\n  useEffect(() => {\r\n    formCurrencies();\r\n  }, []);\r\n\r\n  const value = {\r\n    currencies,\r\n    headers\r\n  }\r\n\r\n  return (\r\n    <GetDataContext.Provider value={value}>\r\n      {children}\r\n    </GetDataContext.Provider>\r\n  )\r\n}\r\n","import React from \"react\";\r\nimport './Loading.scss'\r\n\r\nconst Loading = () => {\r\n\r\n  return (\r\n    <div className=\"lds-ring-wrapper\">\r\n      <div className=\"lds-ring\">\r\n        <div/>\r\n        <div/>\r\n        <div/>\r\n        <div/>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Loading;\r\n","import React from \"react\";\r\nimport './Table.scss';\r\nimport { useGetData } from \"../../contexts/GetDataContext\";\r\nimport Loading from \"../Loading/Loading\";\r\nimport classnames from 'classnames';\r\n\r\nconst Table = () => {\r\n\r\n  const { currencies, headers } = useGetData();\r\n\r\n  return (\r\n    <>\r\n      {\r\n        !currencies\r\n          ? <Loading/>\r\n          :\r\n          <table className={'table'}>\r\n            <thead>\r\n            <tr>\r\n              {headers.length && headers.map((header, idx) => (\r\n                <th key={idx}>{header}</th>\r\n              ))}\r\n            </tr>\r\n            </thead>\r\n            <tbody>\r\n            {currencies && currencies.map((currency, idx) => (\r\n              <tr key={idx}>\r\n                <td>{currency.name}</td>\r\n                <td className={classnames(currency.first.lowest && 'lowest-currency')}>{currency.first.value}</td>\r\n                <td className={classnames(currency.second.lowest && 'lowest-currency')}>{currency.second.value}</td>\r\n                <td className={classnames(currency.third.lowest && 'lowest-currency')}>{currency.third.value}</td>\r\n              </tr>\r\n            ))}\r\n            </tbody>\r\n          </table>\r\n      }\r\n    </>\r\n  )\r\n}\r\n\r\nexport default Table;\r\n","import './App.scss';\nimport { GetDataProvider } from \"./contexts/GetDataContext\";\nimport Table from \"./components/Table/Table\";\n\nfunction App() {\n  return (\n    <GetDataProvider>\n      <Table />\n    </GetDataProvider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}